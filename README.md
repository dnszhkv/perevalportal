# Проект REST API для учёта горных перевалов.

### Описание:
Данный проект разрабатывался в рамках заказа от Федерации Спортивного Туризма и Развития (ФСТР) для студентов [SkillFactory](https://skillfactory.ru) 
с целью упрощения процесса учёта горных перевалов и сокращения времени обработки данных. По заданию необходимо было усовершенствовать REST API для ведения 
базы горных перевалов, пополняемой туристами.

Реализованы методы:
- API POST/submitData для добавления туристом информации о новом перевале; 
- GET /submitData/<id> — получение одной записи о перевале по её id, в том числе статус модерации;
- PATCH /submitData/<id> — редактирование существующей записи, если она ещё не поступила в работу модератору, 
- GET api/submitData/?user__email=<str:email> — список данных обо всех объектах, которые пользователь с почтой <email> отправил на сервер.

REST API опубликован на хостинге [Pythonanywhere](http://dnszhkv.pythonanywhere.com/).

###  Параметры реализации:
1. При подготовке проекта была использована база данных PostgreSQL, для работы с которой необходима библиотека "psycopg2": 
```
pip install psycopg2
```
2. Порт, логин, пароль, путь к базе данных и её название берётся из переменных окружения с использованием библиотеки decouple: 
```
pip install python-decouple
```
3. В файле requirements.txt приведён список внешних зависимостей, который формируется командой pip freeze > requirements.txt.
Команда для установки зависимостей:
```
pip install -r requirements.txt
```

### Работа с API (endpoints):
1. По адресу [/submitData/](http://127.0.0.1:8000/submitData/) можно посмотреть список всех перевалов, а также создать информацию о новом перевале с помощью команды POST.
2. По адресу [/submitData/id](http://127.0.0.1:8000/submitData/1) c помощью команды GET можно получить одну конкретную запись о перевале по её id (в том числе статус 
модерации). По этому же адресу с помощью команды PATCH можно редактировать существующую запись, если она ещё не поступила в работу модератору;
3. Сменить статус модерации можно только через админ-панель по адресу: [/admin](http://127.0.0.1:8000/admin). Возможность работы в ней обеспечивается созданием модератора 
по команде:
```
python manage.py createsuperuser
```
4. По адресу [/api/submitData/user__email=<str:email>](http://127.0.0.1:8000/api/submitData/user__email=email@mail.ru) можно с помощью команды GET 
получить список данных обо всех объектах, которые пользователь с почтой <email> отправил на сервер.
5. По адресу [api/schema/](http://127.0.0.1:8000/api/schema/) генерируется JSON-схема REST API;
6. По адресу [api/docs/](http://127.0.0.1:8000/api/docs/) можно посмотреть Swagger-UI документацию.

Пример JSON-запроса для создания (редактирования) сведений о перевале:
```
{
    "id": 1,
    "add_time": "2024-01-28 07:09:53",
    "user": {
        "id": 1,
        "email": "qwerty@mail.ru",
        "fam": "Пупкин",
        "name": "Василий",
        "otc": "Иванович",
        "phone": "+7 555 55 55"
    },
    "coords": {
        "id": 1,
        "latitude": 45.3842,
        "longitude": 7.1525,
        "height": 1200
    },
    "level": {
        "id": 1,
        "summer": "1А",
        "autumn": "1А",
        "winter": "",
        "spring": ""
    },
    "beauty_title": "пер.",
    "title": "Пхия",
    "other_titles": "Триев",
    "connect": "",
    "status": "new"
}
```